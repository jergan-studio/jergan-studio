<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Jergan Studio</title>
<style>
  body{margin:0;font-family:Segoe UI,Arial,sans-serif;background:#0e0e0e;color:#fff;overflow:hidden;}
  header{background:#111;padding:15px 25px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 10px rgba(0,0,0,0.4);}
  header h1{color:#4c5bff;margin:0;}
  header nav a{color:#ccc;text-decoration:none;margin-left:15px;}
  header nav a:hover{color:#fff;}
  main{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:calc(100vh - 70px);}
  main h2{font-size:2rem;margin-bottom:10px;text-shadow:0 0 20px rgba(76,91,255,0.8);}
  main p{color:#bbb;margin-bottom:25px;}
  button{background-color:#4c5bff;border:none;color:#fff;padding:10px 20px;font-size:15px;border-radius:8px;cursor:pointer;transition:0.3s;}
  button:hover{background-color:#3b48cc;}
  .games{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-top:30px;width:90%;max-width:900px;}
  .card{background:#1b1b1b;border-radius:12px;padding:20px;box-shadow:0 0 15px rgba(76,91,255,0.2);transition:0.3s;}
  .card:hover{transform:translateY(-5px);box-shadow:0 0 25px rgba(76,91,255,0.4);}
  #editorPage{display:none;flex-direction:column;height:100vh;}
  #toolbar{background:#111;padding:10px 20px;display:flex;justify-content:space-between;align-items:center;}
  #toolbar h1{margin:0;color:#4c5bff;}
  #toolbar button{margin-right:6px;}
  #stage{flex:1;background:#1b1b1b;margin:10px auto;border:2px solid #4c5bff;width:800px;height:480px;position:relative;overflow:hidden;}
  .sprite{width:64px;height:64px;position:absolute;border-radius:50%;background:#ff4747;cursor:move;}
  footer{text-align:center;padding:10px;background:#0a0a0a;color:#666;font-size:0.9rem;}
  #scriptPanel{background:#111;padding:8px 15px;border-top:1px solid #333;display:flex;justify-content:center;gap:10px;align-items:center;}
  select,input[type=number]{padding:6px;border-radius:5px;border:none;background:#222;color:#fff;}
  input[type=file]{color:#ccc;}
</style>
</head>
<body>

<header>
  <h1>Jergan Studio</h1>
  <nav>
    <a href="#" id="homeLink">Home</a>
    <a href="#" id="editorLink">Editor</a>
  </nav>
</header>

<!-- HOME PAGE -->
<main id="homePage">
  <h2>Welcome to Jergan Studio</h2>
  <p>Create and play browser-based games ‚Äî no downloads needed!</p>
  <button id="openEditor">üé® Open Game Editor</button>

  <div class="games" id="gameList"></div>
</main>

<!-- EDITOR PAGE -->
<div id="editorPage">
  <div id="toolbar">
    <h1>Editor</h1>
    <div>
      <button id="addSprite">Add Circle</button>
      <button id="uploadSpriteBtn">Upload Sprite</button>
      <button id="saveGame">Save Game</button>
      <button id="backHome">üè† Back Home</button>
    </div>
  </div>
  <div id="stage"></div>

  <div id="scriptPanel">
    <label style="color:#bbb;">Script:</label>
    <select id="scriptAction">
      <option value="move">Move</option>
      <option value="spin">Spin</option>
      <option value="jump">Jump</option>
      <option value="hide">Hide</option>
      <option value="show">Show</option>
    </select>
    <input type="number" id="scriptValue" value="20" style="width:80px">
    <button id="runScript">Run Script</button>
  </div>
</div>

<footer>¬© 2025 Jergan Studio</footer>

<script>
const homePage=document.getElementById("homePage");
const editorPage=document.getElementById("editorPage");
const openEditor=document.getElementById("openEditor");
const homeLink=document.getElementById("homeLink");
const editorLink=document.getElementById("editorLink");
const stage=document.getElementById("stage");
let selectedSprite=null;

// --- PAGE SWITCHING ---
openEditor.onclick=()=>showEditor();
editorLink.onclick=(e)=>{e.preventDefault();showEditor();};
homeLink.onclick=(e)=>{e.preventDefault();showHome();};
document.getElementById("backHome").onclick=()=>showHome();

function showEditor(){
  homePage.style.display="none";
  editorPage.style.display="flex";
  stage.innerHTML="";
  selectedSprite=null;
}

function showHome(){
  editorPage.style.display="none";
  homePage.style.display="flex";
  loadGames();
}

// --- DRAGGABLE SPRITES ---
function makeDraggable(el){
  let offX,offY,isDown=false;
  el.onmousedown=e=>{
    isDown=true;offX=e.offsetX;offY=e.offsetY;
    selectedSprite=el;
    document.querySelectorAll(".sprite").forEach(s=>s.style.outline="none");
    el.style.outline="2px solid #4c5bff";
  };
  document.onmouseup=()=>isDown=false;
  document.onmousemove=e=>{
    if(!isDown)return;
    const rect=stage.getBoundingClientRect();
    el.style.left=(e.clientX-rect.left-offX)+"px";
    el.style.top=(e.clientY-rect.top-offY)+"px";
  };
}

// --- ADD DEFAULT CIRCLE ---
document.getElementById("addSprite").onclick=()=>{
  const s=document.createElement("div");
  s.className="sprite";
  s.style.left=Math.random()*720+"px";
  s.style.top=Math.random()*400+"px";
  makeDraggable(s);
  stage.appendChild(s);
};

// --- UPLOAD SPRITE ---
document.getElementById("uploadSpriteBtn").onclick=()=>{
  const input=document.createElement("input");
  input.type="file";
  input.accept="image/*";
  input.onchange=e=>{
    const file=e.target.files[0];
    if(file){
      const reader=new FileReader();
      reader.onload=()=>{
        const s=document.createElement("div");
        s.className="sprite";
        s.style.borderRadius="0";
        s.style.backgroundImage=`url('${reader.result}')`;
        s.style.backgroundSize="cover";
        s.style.left=Math.random()*720+"px";
        s.style.top=Math.random()*400+"px";
        makeDraggable(s);
        stage.appendChild(s);
      };
      reader.readAsDataURL(file);
    }
  };
  input.click();
};

// --- SCRIPTING ---
document.getElementById("runScript").onclick=()=>{
  if(!selectedSprite){alert("Select a sprite first!");return;}
  const action=document.getElementById("scriptAction").value;
  const value=parseInt(document.getElementById("scriptValue").value);
  switch(action){
    case "move":
      const x=(parseInt(selectedSprite.style.left)||0)+value;
      selectedSprite.style.left=x+"px";
      break;
    case "spin":
      selectedSprite.style.transition="transform 0.3s linear";
      selectedSprite.style.transform=`rotate(${value}deg)`;
      break;
    case "jump":
      selectedSprite.style.transition="top 0.3s ease";
      const y=parseInt(selectedSprite.style.top)||0;
      selectedSprite.style.top=(y-50)+"px";
      setTimeout(()=>{selectedSprite.style.top=y+"px";},400);
      break;
    case "hide":
      selectedSprite.style.display="none";
      break;
    case "show":
      selectedSprite.style.display="block";
      break;
  }
};

// --- SAVE GAME ---
document.getElementById("saveGame").onclick=()=>{
  const title=prompt("Game title?");
  const description=prompt("Short description?");
  const html=`<!DOCTYPE html><html><body style='margin:0;background:black;overflow:hidden;'>${
    stage.innerHTML
  }<script>document.querySelectorAll('.sprite').forEach(s=>{s.onmousedown=e=>{let x=e.offsetX,y=e.offsetY;document.onmousemove=m=>{s.style.left=m.pageX-x+'px';s.style.top=m.pageY-y+'px';};document.onmouseup=()=>{document.onmousemove=null;};};});<\/script></body></html>`;
  const games=JSON.parse(localStorage.getItem("jerganGames")||"[]");
  games.push({title,description,code:html});
  localStorage.setItem("jerganGames",JSON.stringify(games));
  alert("Game saved! Returning to home.");
  showHome();
};

// --- LOAD SAVED GAMES ---
function loadGames(){
  const list=document.getElementById("gameList");
  const games=JSON.parse(localStorage.getItem("jerganGames")||"[]");
  list.innerHTML="";
  if(games.length===0){
    list.innerHTML="<p>No games yet. Click 'Open Game Editor' to make one!</p>";
  }else{
    games.forEach((g,i)=>{
      const div=document.createElement("div");
      div.className="card";
      div.innerHTML=`<h3>${g.title||"Untitled Game"}</h3><p>${g.description||"No description"}</p><button onclick="playGame(${i})">‚ñ∂ Play</button>`;
      list.appendChild(div);
    });
  }
}

// --- PLAY GAME ---
function playGame(i){
  const games=JSON.parse(localStorage.getItem("jerganGames")||"[]");
  const g=games[i];
  const blob=new Blob([g.code],{type:"text/html"});
  const url=URL.createObjectURL(blob);
  window.open(url,"_blank");
}

// Initialize on load
loadGames();
</script>
</body>
</html>
